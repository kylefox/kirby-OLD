#!/usr/bin/env python
import sys
import os
import kirby
from kirby.core import Kirby
from kirby.server import runserver

if __name__ == "__main__":
  command = sys.argv[1]
  if command == 'serve':
    dirs = os.listdir(os.getcwd()) 
    if 'content' in dirs and 'templates' in dirs:
        runserver(os.getcwd())
    else:
      print "Directory not initialized properly!"
      sys.exit(0)
  elif command == 'new':
    try:
      ROOT_PATH = os.path.join(os.getcwd(), sys.argv[2])
      if os.path.isdir(ROOT_PATH):
        print "%s already exists!" % ROOT_PATH
        sys.exit(0)
      print "Creating new Kirby site at %s" % ROOT_PATH
      Kirby.create_site(ROOT_PATH)
    except IndexError:
      print "You must specify a site name: kirby new [NAME]"
      sys.exit(0)
  else:
    print "Command '%s' not recognized." % command
    sys.exit(0)